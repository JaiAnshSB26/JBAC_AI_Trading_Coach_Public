<div class="auth-container">
  <div class="auth-card">
    <!-- Logo/Header -->
    <div class="auth-header">
      <h1>JBAC AI Trading Coach</h1>
      <p class="subtitle">{{ isLoginMode ? 'Welcome Back' : 'Create Your Account' }}</p>
    </div>

    <!-- Error Message -->
    <div *ngIf="errorMessage" class="error-message">
      <mat-icon>error</mat-icon>
      <span>{{ errorMessage }}</span>
    </div>

    <!-- Login Form -->
    <form *ngIf="isLoginMode" [formGroup]="loginForm" (ngSubmit)="onLogin()" class="auth-form">
      <div class="form-group">
        <label for="login-email">Email Address</label>
        <input
          id="login-email"
          type="email"
          formControlName="email"
          placeholder="you@example.com"
          [class.invalid]="getLoginControl('email')?.invalid && getLoginControl('email')?.touched"
        />
        <div *ngIf="getLoginControl('email')?.invalid && getLoginControl('email')?.touched" class="field-error">
          <span *ngIf="getLoginControl('email')?.errors?.['required']">Email is required</span>
          <span *ngIf="getLoginControl('email')?.errors?.['email']">Please enter a valid email</span>
        </div>
      </div>

      <div class="form-group">
        <label for="login-password">Password</label>
        <input
          id="login-password"
          type="password"
          formControlName="password"
          placeholder="••••••••"
          [class.invalid]="getLoginControl('password')?.invalid && getLoginControl('password')?.touched"
        />
        <div *ngIf="getLoginControl('password')?.invalid && getLoginControl('password')?.touched" class="field-error">
          <span *ngIf="getLoginControl('password')?.errors?.['required']">Password is required</span>
          <span *ngIf="getLoginControl('password')?.errors?.['minlength']">Password must be at least 6 characters</span>
        </div>
      </div>

      <button type="submit" class="submit-btn" [disabled]="loading || loginForm.invalid">
        <span *ngIf="!loading">Sign In</span>
        <span *ngIf="loading" class="loading-spinner">Signing in...</span>
      </button>
    </form>

    <!-- Register Form -->
    <form *ngIf="!isLoginMode" [formGroup]="registerForm" (ngSubmit)="onRegister()" class="auth-form">
      <div class="form-group">
        <label for="register-name">Display Name</label>
        <input
          id="register-name"
          type="text"
          formControlName="displayName"
          placeholder="John Doe"
          [class.invalid]="getRegisterControl('displayName')?.invalid && getRegisterControl('displayName')?.touched"
        />
        <div *ngIf="getRegisterControl('displayName')?.invalid && getRegisterControl('displayName')?.touched" class="field-error">
          <span *ngIf="getRegisterControl('displayName')?.errors?.['required']">Display name is required</span>
          <span *ngIf="getRegisterControl('displayName')?.errors?.['minlength']">Name must be at least 2 characters</span>
        </div>
      </div>

      <div class="form-group">
        <label for="register-email">Email Address</label>
        <input
          id="register-email"
          type="email"
          formControlName="email"
          placeholder="you@example.com"
          [class.invalid]="getRegisterControl('email')?.invalid && getRegisterControl('email')?.touched"
        />
        <div *ngIf="getRegisterControl('email')?.invalid && getRegisterControl('email')?.touched" class="field-error">
          <span *ngIf="getRegisterControl('email')?.errors?.['required']">Email is required</span>
          <span *ngIf="getRegisterControl('email')?.errors?.['email']">Please enter a valid email</span>
        </div>
      </div>

      <div class="form-group">
        <label for="register-password">Password</label>
        <input
          id="register-password"
          type="password"
          formControlName="password"
          placeholder="••••••••"
          [class.invalid]="getRegisterControl('password')?.invalid && getRegisterControl('password')?.touched"
        />
        <div *ngIf="getRegisterControl('password')?.invalid && getRegisterControl('password')?.touched" class="field-error">
          <span *ngIf="getRegisterControl('password')?.errors?.['required']">Password is required</span>
          <span *ngIf="getRegisterControl('password')?.errors?.['minlength']">Password must be at least 6 characters</span>
        </div>
      </div>

      <div class="form-group">
        <label for="register-confirm">Confirm Password</label>
        <input
          id="register-confirm"
          type="password"
          formControlName="confirmPassword"
          placeholder="••••••••"
          [class.invalid]="getRegisterControl('confirmPassword')?.invalid && getRegisterControl('confirmPassword')?.touched"
        />
        <div *ngIf="getRegisterControl('confirmPassword')?.touched && registerForm.errors?.['passwordMismatch']" class="field-error">
          <span>Passwords do not match</span>
        </div>
      </div>

      <button type="submit" class="submit-btn" [disabled]="loading || registerForm.invalid">
        <span *ngIf="!loading">Create Account</span>
        <span *ngIf="loading" class="loading-spinner">Creating account...</span>
      </button>
    </form>

    <!-- Divider -->
    <div class="divider">
      <span>or</span>
    </div>

    <!-- Google Sign-In Button (Dynamic) -->
    <div id="google-signin-button" class="google-signin-wrapper"></div>

    <!-- Fallback for Google Sign-In -->
    <button type="button" class="google-btn-fallback" style="display: none;">
      <svg width="18" height="18" viewBox="0 0 18 18">
        <path fill="#4285F4" d="M17.64 9.2c0-.637-.057-1.251-.164-1.84H9v3.481h4.844c-.209 1.125-.843 2.078-1.796 2.717v2.258h2.908c1.702-1.567 2.684-3.875 2.684-6.615z"/>
        <path fill="#34A853" d="M9 18c2.43 0 4.467-.806 5.956-2.18l-2.908-2.259c-.806.54-1.837.86-3.048.86-2.344 0-4.328-1.584-5.036-3.711H.957v2.332C2.438 15.983 5.482 18 9 18z"/>
        <path fill="#FBBC05" d="M3.964 10.71c-.18-.54-.282-1.117-.282-1.71s.102-1.17.282-1.71V4.958H.957C.347 6.173 0 7.548 0 9s.348 2.827.957 4.042l3.007-2.332z"/>
        <path fill="#EA4335" d="M9 3.58c1.321 0 2.508.454 3.44 1.345l2.582-2.58C13.463.891 11.426 0 9 0 5.482 0 2.438 2.017.957 4.958L3.964 7.29C4.672 5.163 6.656 3.58 9 3.58z"/>
      </svg>
      <span>Continue with Google</span>
    </button>

    <!-- Toggle Mode Link -->
    <div class="toggle-mode">
      <p *ngIf="isLoginMode">
        Don't have an account?
        <a href="#" (click)="toggleMode(); $event.preventDefault()">Sign up</a>
      </p>
      <p *ngIf="!isLoginMode">
        Already have an account?
        <a href="#" (click)="toggleMode(); $event.preventDefault()">Sign in</a>
      </p>
    </div>
  </div>
</div>
